# RiboswitchClassification

[riboflow](https://test.pypi.org/project/riboflow/) is a python package for classifying putative riboswitch sequences into one of 24 classes with > 99% accuracy. It is based on a [tensorflow](https://www.tensorflow.org) deep learning model. ``riboflow`` has been tested using ``Python 3.5.2``. 
The pip package was derived from this source code. This source code of ``rnnApp.py`` and ``cnnApp.py`` can easily be altered to help acheive better accuracy when the riboswitch labels change or the number of labels increase / decrease when constructing the dataset, by changing the number of NN layers, hyperparameters.  

Datasets, Models, Utility Files
------------

1.original_datasets

    a. 24_riboswitches_fasta    --> Fasta   Format of the 24 riboswitches
    b. 24_riboswitches_new_csv  --> CSV     Format of the 24 riboswitches
    
2.processed_datasets

    a. final.csv                --> Original 24 riboswitches Dataset cleaned and Frequencies calculated
    b. final_train.csv          --> 90% of each riboswitches label in the final.csv
    c. final_test.csv           --> Remaining 10% of each riboswitches label in the final.csv
    
3.pickled_models

    Contains all the trained sklearn models (generated by RocAucAllBaselineModels.py) saved in pkl format
    
4.models

    Contains the rnn and cnn model's saved in h5 format 
    
5.aucRoc.py

    Used by the cnn and rnn for auc-roc generation

6.split_dataset.py

    Used to generate final_train.csv and final_test.csv which is used by RocAucAllBaselineModels.py, rnnApp.py, cnnApp.py 
    
7.aucRoc.py

    Used by the cnn and rnn for auc-roc generation
    
8.dynamic.py [IMPORTANT]
    
    Can used on riboswitch fasta files of any number of classes to generate the equivalent processed csv files having the  
    sequence and frequency (this file can be used RocAucAllBaselineModels.py, rnnApp.py, cnnApp.py for training purposes) 
    
Baseline Models Constructed using Sklearn Library
------------

    > python3  RocAucAllBaselineModels.py
    
    1. Create's a Picked Model for each of the sklearn classifers stated below:
        AdaBoostClassifier(),
        GaussianNB(),
        KNeighborsClassifier(),
        DecisionTreeClassifier(),
        RandomForestClassifier(),
        MLPClassifier()
    2. Each model is used on the test set to obtain accuracy, generate a classication report and the ROC-AUC values for each 
       of the 24 classes. 
    3. The MLPClassifier() proved to be the best among the chosen sklearn classifiers and hence Neural Networks (CNN and RNN) 
       were explored further to acheive greater accuracy.
 
 RNN
------------

    > python3  rnnApp.py
    
    1. Create's a .h5 RNN Model
    2. The model is used on the test set to obtain accuracy, generate a classication report and the ROC-AUC values for each 
       of the 24 classes. 
    3. Provides an Accuracy of 99% on the test set.
    4. New layers and hyperparameter values can be added or changed when dealing with a dataset having different number of classes
    5. The train time is fairly long ( in the magnitude of hours - suitable for system with high specs )
    
CNN
------------

    > python3  cnnApp.py
    
    1. Create's a .h5 RNN Model
    2. The model is used on the test set to obtain accuracy, generate a classication report and the ROC-AUC values for each 
       of the 24 classes. 
    3. Provides an Accuracy of 97% on the test set.
    4. New layers and hyperparameter values can be added or changed when dealing with a dataset having different number of classes.
    5. The train time is fairly short ( < 1 min - suitable for low spec systems )
 
    
